<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?define ProductName = "Git Auto Commit" ?>
  <?define Manufacturer = "Algernon Coop" ?>
  <?define UpgradeCode = "12345678-1234-1234-1234-123456789012" ?>
  
  <Product Id="*" 
           Name="$(var.ProductName)" 
           Language="1033" 
           Version="$(var.Version)" 
           Manufacturer="$(var.Manufacturer)" 
           UpgradeCode="$(var.UpgradeCode)">
    
    <Package InstallerVersion="200" 
             Compressed="yes" 
             InstallScope="perMachine" 
             Platform="$(var.Platform)"
             Description="A cross-platform CLI tool that automatically generates meaningful commit messages using AI" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of $(var.ProductName) is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" 
             Title="Git Auto Commit" 
             Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="EnvironmentPathComponent" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="$(var.ProgramFilesFolder)">
        <Directory Id="ManufacturerFolder" Name="$(var.Manufacturer)">
          <Directory Id="INSTALLFOLDER" Name="$(var.ProductName)" />
        </Directory>
      </Directory>
    </Directory>

    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="MainExecutable" Guid="*">
        <File Id="GitAutoCommitExe" 
              Source="$(var.BinaryPath)" 
              KeyPath="yes" 
              Checksum="yes" />
      </Component>
    </ComponentGroup>

    <!-- Add to PATH environment variable -->
    <Component Id="EnvironmentPathComponent" 
               Directory="INSTALLFOLDER" 
               Guid="87654321-4321-4321-4321-210987654321">
      <Environment Id="PATH" 
                   Name="PATH" 
                   Value="[INSTALLFOLDER]" 
                   Permanent="no" 
                   Part="last" 
                   Action="set" 
                   System="yes" />
    </Component>

    <!-- UI Configuration -->
    <UIRef Id="WixUI_Minimal" />
  </Product>
</Wix>
